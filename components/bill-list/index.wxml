<view class="bill-list">
  <!-- Ë¥¶ÂçïÂàóË°® -->
  <block wx:if="{{loading}}">
    <view class="loading">
      <view class="loading-spinner"></view>
      <text>Âä†ËΩΩ‰∏≠...</text>
    </view>
  </block>
  <block wx:elif="{{error}}">
    <view class="error">
      <icon type="warn" size="40" color="#ff4d4f"></icon>
      <text>{{error}}</text>
    </view>
  </block>
  <block wx:elif="{{bills.length === 0}}">
    <view class="empty">
      <icon type="info" size="40" color="#999"></icon>
      <text>ÊöÇÊó†Ë¥¶Âçï</text>
    </view>
  </block>
  <block wx:else>
    <view class="bill-items">
      <block wx:for="{{bills}}" wx:key="no">
        <!-- ÊªëÂä®Âà†Èô§ÂÆπÂô® -->
        <view class="swipe-area">
          <!-- Êó•ÊúüÂàÜÁªÑÂ§¥ÔºåÂú®Êó•ÊúüÂèòÂåñÊàñÊòØÁ¨¨‰∏ÄÈ°πÊó∂ÊòæÁ§∫ -->
          <view wx:if="{{index === 0 || item.date !== bills[index - 1].date}}" class="date-header">
            {{item.date}}
          </view>
          <movable-area style="width: 100%; height: 140rpx;">
            <movable-view class="swipe-item" direction="horizontal" x="{{item.slideX}}"
              out-of-bounds="true" damping="20" friction="2" disabled="{{false}}"
              bindtouchstart="handleTouchStart" bindtouchend="handleTouchEnd"
              data-index="{{index}}" data-no="{{item.no}}" style="width: calc(100% + 150rpx);">
              <!-- Ë¥¶ÂçïÂÜÖÂÆπÔºåÊ†πÊçÆ transactionType Âà§Êñ≠Êî∂ÂÖ•ÊàñÊîØÂá∫Ôºö1=Êî∂ÂÖ•ÊòæÁ§∫+Ôºå2=ÊîØÂá∫ÊòæÁ§∫- -->
              <view class="bill-item {{item.transactionType === 1 ? 'income' : 'expense'}}" bindtap="onTapItem" data-no="{{item.no}}">
                <view class="bill-left">
                  <view class="icon">{{item.categoryIcon || 'üìù'}}</view>
                  <view class="meta">
                    <text class="category">{{item.categoryName}}</text>
                    <text class="desc">{{item.desc}}</text>
                    <text class="time">{{formatTime(item.time)}}</text>
                  </view>
                </view>
                <view class="bill-right">
                  <!-- transactionType: 1=Êî∂ÂÖ•ÊòæÁ§∫+Âè∑Ôºå2=ÊîØÂá∫ÊòæÁ§∫-Âè∑ -->
                  <text class="amount {{item.transactionType === 1 ? 'income-text' : 'expense-text'}}">{{item.transactionType === 1 ? '+' : '-'}}¬•{{item.formattedAmount}}</text>
                </view>
              </view>
              <!-- Âà†Èô§ÊåâÈíÆ -->
              <view class="delete-btn" bindtap="deleteBill" data-no="{{item.no}}">Âà†Èô§</view>
            </movable-view>
          </movable-area>
        </view>
      </block>
    </view>
  </block>
</view> 