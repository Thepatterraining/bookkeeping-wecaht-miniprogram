<view class="container">
  <view class="page-title">åˆ†ç±»ç®¡ç†</view>

  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tabs">
    <view class="tab {{activeTab==='expense'?'active':''}}" data-tab="expense" bindtap="switchTab">æ”¯å‡º</view>
    <view class="tab {{activeTab==='income'?'active':''}}" data-tab="income" bindtap="switchTab">æ”¶å…¥</view>
  </view>

  <!-- åˆ†ç±»åˆ—è¡¨ -->
  <view class="category-list">
    <block wx:if="{{activeTab === 'expense'}}">
      <view class="category-item" wx:for="{{categories.expense}}" wx:key="id">
        <view class="category-info">
          <text class="category-icon">{{item.icon}}</text>
          <text class="category-name">{{item.name}}</text>
        </view>
        <view class="category-actions">
          <text class="action-icon edit" bindtap="editCategory" data-id="{{item.id}}" data-type="expense">âœï¸</text>
          <text class="action-icon delete" bindtap="deleteCategory" data-id="{{item.id}}" data-type="expense">ğŸ—‘ï¸</text>
        </view>
      </view>
    </block>

    <block wx:if="{{activeTab === 'income'}}">
      <view class="category-item" wx:for="{{categories.income}}" wx:key="id">
        <view class="category-info">
          <text class="category-icon">{{item.icon}}</text>
          <text class="category-name">{{item.name}}</text>
        </view>
        <view class="category-actions">
          <text class="action-icon edit" bindtap="editCategory" data-id="{{item.id}}" data-type="income">âœï¸</text>
          <text class="action-icon delete" bindtap="deleteCategory" data-id="{{item.id}}" data-type="income">ğŸ—‘ï¸</text>
        </view>
      </view>
    </block>
  </view>

  <!-- æ·»åŠ åˆ†ç±»æŒ‰é’® -->
  <view class="add-category-btn" bindtap="showAddCategoryModal">
    <text class="add-icon">+</text>
    <text>æ·»åŠ åˆ†ç±»</text>
  </view>

  <!-- æ·»åŠ åˆ†ç±»å¼¹çª— -->
  <view class="modal" wx:if="{{showAddModal}}" catchtouchmove="preventTouchMove">
    <view class="modal-backdrop" bindtap="hideAddCategoryModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">æ·»åŠ {{activeTab === 'expense' ? 'æ”¯å‡º' : 'æ”¶å…¥'}}åˆ†ç±»</text>
        <text class="modal-close" bindtap="hideAddCategoryModal">Ã—</text>
      </view>
      <view class="modal-body">
        <view class="form-group">
          <text class="form-label">åˆ†ç±»åç§°</text>
          <input class="form-input" placeholder="è¯·è¾“å…¥åˆ†ç±»åç§°" value="{{newCategory.name}}" bindinput="onCategoryNameInput" />
        </view>

        <view class="form-group">
          <text class="form-label">é€‰æ‹©å›¾æ ‡</text>
          <view class="icon-grid">
            <view class="icon-item {{newCategory.icon === icon ? 'selected' : ''}}"
                  wx:for="{{icons}}"
                  wx:for-item="icon"
                  wx:key="*this"
                  bindtap="selectIcon"
                  data-icon="{{icon}}">
              {{icon}}
            </view>
          </view>
        </view>

        <button class="submit-btn" bindtap="addCategory">ç¡®è®¤æ·»åŠ </button>
      </view>
    </view>
  </view>
</view>
