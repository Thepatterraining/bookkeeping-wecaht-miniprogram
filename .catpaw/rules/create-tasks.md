---
ruleType: Model Request
description: 创建task
globs:
---
### 4. 创建任务清单

在用户批准设计后，根据需求与设计制定一份可落地的实现计划，并以代码任务清单的形式呈现。  
任务文档需以设计文档(`.spec/{feature_name}/design.md`)为基础，因此请先确认其存在。

**约束条件：**

- 若尚不存在，模型 **必须** 创建文件 `.spec/{feature_name}/tasks.md`
- 若用户指出设计需要修改，模型 **必须** 返回设计步骤
- 若用户指出需要补充需求，模型 **必须** 返回需求步骤
- 模型 **必须** 在 `.spec/{feature_name}/tasks.md` 中生成实现计划
- 模型 **必须** 严格遵循以下具体指令来撰写实现计划：
  - 将功能设计拆分为一系列面向代码生成 LLM 的提示，采用测试驱动的实现方式。对应的单元测试 **不要** 单独作为独立的任务。
  - 优先遵循最佳实践、逐步推进、早期测试，确保任何阶段都不出现复杂度跳跃。
  - 每个提示都必须基于前一个提示构建，最终完成所有模块的"连线"。
  - 不允许出现悬而未决或无法与前置步骤集成的孤立代码。
  - 仅关注"编写、修改或测试代码"的任务。
- 模型必须将实施计划格式化为带编号的复选框列表，最多两级层次结构：
  - 顶级项目只在需要时使用
  - 子任务应使用十进制记号编号（例如 1.1、1.2、2.1）
  - 每个项目必须是复选框
  - 优先使用简单结构
- 模型必须确保每个任务项目包括：
  - 作为任务描述的明确目标，涉及编写、修改或测试代码
  - 任务下的子项目形式的附加信息
  - 对需求文档中需求的具体引用（引用细粒度子需求，而不仅仅是用户故事）
- 模型必须确保实施计划是一系列离散的、可管理的编码步骤
- 模型必须确保每个任务引用需求文档中的具体需求
- 模型不得包含设计文档中已涵盖的过度实施细节
- 模型必须假设在实施期间所有上下文文档（功能需求、设计）都可用
- 模型必须确保每个步骤在前面步骤的基础上增量构建
- 模型应在适当时优先考虑测试驱动开发
- **模型在创建测试相关任务时，除非用户明确要求其他类型测试，应仅包含单元测试任务，不包含集成测试、端到端测试、性能测试等其他测试类型的任务**
- 模型必须确保计划涵盖可通过代码实施的设计的所有方面
- 模型应排序步骤以通过代码早期验证核心功能
- 模型必须确保所有需求都被实施任务覆盖
- 如果在实施计划期间发现差距，模型 **必须** 提供返回前面步骤（需求或设计）的选项
- 模型必须仅包含编码代理可以执行的任务（编写代码、创建测试等）
- 模型不得包含与用户测试、部署、性能指标收集或其他非编码活动相关的任务
- 模型必须专注于可在开发环境中执行的代码实施任务
- 模型必须通过遵循以下准则确保每个任务可由编码代理执行：
  - 任务应涉及编写、修改或测试特定代码组件
  - 任务应指定需要创建或修改的文件或组件
  - 任务应足够具体，编码代理可以在不需要额外澄清的情况下执行
  - 任务应专注于实施细节而不是高级概念
  - 任务应限定为特定编码活动（例如"实施X函数"而不是"支持X功能"）
- 模型必须明确避免在实施计划中包含以下类型的非编码任务：
  - 用户验收测试或用户反馈收集
  - 运行应用程序以测试端到端流程。但是，我们可以编写自动化测试从用户角度测试端到端
  - 用户培训或文档创建
  - 任何无法通过编写、修改或测试代码完成的任务
- 更新任务文档后，模型必须询问用户"任务看起来怎么样？"
- 如果用户请求更改或未明确批准，模型必须对任务文档进行修改
- 模型必须在任务文档的每次编辑迭代后请求明确批准
- 模型必须在收到明确批准（如"是"、"批准"、"看起来不错"等）之前不得认为工作流程完成
- 模型必须继续反馈-修订循环，直到收到明确批准
- 一旦任务文档被批准，模型必须停止

**此工作流程仅用于创建设计和计划。功能的实际实施应通过单独的工作流程完成。**

- 模型不得尝试在此工作流程中实施计划
- 一旦创建了设计和计划，模型必须向用户清楚传达此工作流程已完成 
